// cisakevc represents the CISA Known Exploited Vulnerability Catalog.
package cisakev

import "errors"

type VulnerabilitySet struct {
	Data map[string]Vulnerability
}

func NewVulnerabilitySet() *VulnerabilitySet {
	return &VulnerabilitySet{
		Data: map[string]Vulnerability{},
	}
}

func (set VulnerabilitySet) Add(v Vulnerability) error {
	if set.Data == nil {
		set.Data = map[string]Vulnerability{}
	}
	if v.CVEID == "" {
		return errors.New("cveID is required")
	} else {
		set.Data[v.CVEID] = v
		return nil
	}
}

func (set VulnerabilitySet) CVE(cveID string) *Vulnerability {
	if set.Data == nil {
		return nil
	} else if v, ok := set.Data[cveID]; !ok {
		return nil
	} else {
		return &v
	}
}

func (set VulnerabilitySet) CVEDueDate(cveID string) string {
	if set.Data == nil {
		return ""
	} else if v, ok := set.Data[cveID]; !ok {
		return ""
	} else {
		return v.DueDate
	}
}
